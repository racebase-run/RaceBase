(window.webpackJsonp=window.webpackJsonp||[]).push([[84],{470:function(e,t,n){var content=n(593);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(12).default)("be9c0002",content,!0,{sourceMap:!1})},592:function(e,t,n){"use strict";var r=n(470);n.n(r).a},593:function(e,t,n){(t=n(11)(!1)).push([e.i,".fa-cog[data-v-719066e0]{color:#333;font-size:20px;margin-bottom:1px;margin-right:5px}.fa-times[data-v-719066e0]{cursor:pointer}.pic-name[data-v-719066e0]{font-size:12px;text-align:center}.pictures[data-v-719066e0]{width:90%}.claim[data-v-719066e0]{display:inline-block;width:270px}.claim .btn.btn-primary[data-v-719066e0]{margin-top:0}.settings-section[data-v-719066e0]{margin-top:20px}.settings-section .btn[data-v-719066e0]{font-size:15px}.settings-section .settings-label[data-v-719066e0]{text-transform:uppercase;font-weight:500;font-size:13px;margin-bottom:10px}.settings-section .tag[data-v-719066e0]{font-size:14px;vertical-align:middle;border-radius:4px;border:1px solid #ccc;padding:6px 12px;display:inline-block;white-space:nowrap;margin-bottom:9px}.settings-section .alert[data-v-719066e0]{width:270px;padding:8px 12px}.settings-section .athlete-id .btn[data-v-719066e0]{margin-top:-9.5px}form input[data-v-719066e0]{font-size:14px}@media screen and (max-width:767px){.alert[data-v-719066e0],.claim[data-v-719066e0]{width:90%;margin:10px auto 0}.danger-zone[data-v-719066e0]{margin-bottom:50px}}",""]),e.exports=t},786:function(e,t,n){"use strict";n.r(t);n(54),n(21),n(20),n(7),n(44);var r=n(25),c=(n(24),n(3));function o(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var d,v,m,h,f,_,x={data:function(){return{id:"",deleteSuccess:"",makeSure:!1,profilePic:null,brandPic:null,featuredPic:null,message:"",imageMessage:"",joinCode:""}},components:{ProfilePic:function(){return n.e(2).then(n.bind(null,825))},SettingsNav:function(){return n.e(10).then(n.bind(null,833))}},head:function(){return{title:"Settings - RaceBase"}},middleware:"auth",asyncData:function(e){return Object(c.a)(regeneratorRuntime.mark((function t(){var n,r,c,o,d,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.store,r=e.$axios,c=l({},n.state.auth.user),o=null,t.prev=3,!c.team_id||!c.coach){t.next=10;break}return t.next=7,r.$get("/team/"+c.team_id);case 7:o=t.sent,t.next=14;break;case 10:if(!c.team_id){t.next=14;break}return t.next=13,r.$get("/team/public/"+c.team_id);case 13:o=t.sent;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(3),console.log(t.t0);case 19:return d=c.email,v=0,t.prev=21,t.next=24,r.$get("/user/referrals");case 24:v=t.sent.referrals,t.next=30;break;case 27:t.prev=27,t.t1=t.catch(21),console.log(t.t1.response.data);case 30:return t.abrupt("return",{user:c,id:c._id,resent:!1,sentReset:!1,referrals:v,currentEmail:d,emailMessage:"",team:o,coachAccount:c.coach});case 31:case"end":return t.stop()}}),t,null,[[3,16],[21,27]])})))()},methods:{loadUser:(_=Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("auth/fetchUser");case 2:this.user=l({},this.$store.state.auth.user),this.currentEmail=this.user.email;case 4:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)}),joinTeam:(f=Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.$post("team/join/"+this.joinCode);case 3:e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0.response.data);case 9:this.loadUser();case 10:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return f.apply(this,arguments)}),leaveTeam:(h=Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.$post("team/leave");case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0.response.data);case 8:this.loadUser();case 9:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(){return h.apply(this,arguments)}),deleteAccount:(m=Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.$delete("user/"+this.id);case 2:return e.next=4,this.$store.dispatch("auth/logout");case 4:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)}),updateEmail:function(){var e=this;this.$axios.$put("user/email/"+this.user.email).then((function(t){e.emailMessage=t,e.loadUser()})).catch((function(t){console.log(t),e.emailMessage=t.response.data}))},changeAccountType:function(){var e=this;this.$axios.$put("user/coach",{coach:this.coachAccount}).then((function(t){e.loadUser()})).catch((function(e){console.log(e)}))},resendVerification:(v=Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.post("user/resendVerification");case 2:this.resent=!0;case 3:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)}),addToClipboard:function(){document.querySelector("#copy").select(),document.execCommand("copy"),this.copied=!0},resetPassword:(d=Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.$post("/user/forgotPassword",{email:this.user.email});case 3:this.sentReset=!0,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return d.apply(this,arguments)})}},C=(n(592),n(16)),component=Object(C.a)(x,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"mx-auto w-90 w-md-100 mx-md-0 pl-md-5"},[n("h1",{staticClass:"mt-4"},[n("fa",{attrs:{icon:"cogs"}}),e._v(" Settings \n  ")],1),e._v(" "),n("SettingsNav",{attrs:{coach:e.user.coach}}),e._v(" "),n("div",{staticClass:"settings-section"},[n("div",{staticClass:"settings-label"},[e._v("Email")]),e._v(" "),n("div",[n("form",{staticClass:"input-group mb-2 w-50",on:{submit:function(t){return t.preventDefault(),e.updateEmail(t)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.user.email,expression:"user.email"}],staticClass:"form-control",attrs:{type:"email",placeholder:"Change your email..."},domProps:{value:e.user.email},on:{input:function(t){t.target.composing||e.$set(e.user,"email",t.target.value)}}}),e._v(" "),n("span",{staticClass:"input-group-append"},[n("button",{staticClass:"btn btn-outline-dark",attrs:{type:"submit"}},[n("fa",{attrs:{icon:e.user.email==e.currentEmail?"check":"save"}})],1)])])]),e._v(" "),e.emailMessage?n("div",[e._v(e._s(e.emailMessage))]):e._e(),e._v(" "),e.user.active?n("div",[e._v(" Your email has been verified. ")]):n("div",[e._v("\n      Please verify your email! \n      Click \n      "),n("a",{attrs:{href:"#"},on:{click:e.resendVerification}},[e._v("here")]),e._v(" \n      to resend your verification email.\n      "),e.resent?n("p",[n("strong",[e._v("Sent.")])]):e._e()])]),e._v(" "),n("div",{staticClass:"settings-section"},[n("div",{staticClass:"settings-label"},[e._v("Reset Password")]),e._v(" "),n("div",[e._v("\n      Click \n      "),n("a",{attrs:{href:"#"},on:{click:e.resetPassword}},[e._v("here")]),e._v(" \n      to send a reset link to your email.\n      "),e.sentReset?n("p",[n("strong",[e._v("Sent.")])]):e._e()])]),e._v(" "),n("div",{staticClass:"settings-section mt-4"},[n("div",{staticClass:"settings-label"},[e._v("Referral Code")]),e._v(" "),n("div",{staticClass:"mb-2"},[e._v("\n      Refer 5 friends with this code and get a free RaceBase tee shirt!\n    ")]),e._v(" "),n("div",{staticClass:"input-group w-50"},[n("input",{staticClass:"form-control",attrs:{id:"copy",readonly:""},domProps:{value:e.user.referralCode}}),e._v(" "),n("span",{staticClass:"input-group-append"},[n("div",{staticClass:"btn btn-outline-dark",on:{click:e.addToClipboard}},[n("fa",{attrs:{icon:"clipboard"}})],1)])]),e._v(" "),n("div",{staticClass:"mt-2"},[n("strong",[e._v(" \n        You have "+e._s(e.referrals||0)+" referral"),1!=e.referrals?n("span",[e._v("s")]):e._e(),e._v(". \n      ")])])]),e._v(" "),n("div",{staticClass:"settings-section"},[n("div",{staticClass:"settings-label"},[e._v(" Account Type ")]),e._v(" "),n("div",[n("label",{staticClass:"form-check-label mb-3"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.coachAccount,expression:"coachAccount"}],attrs:{type:"radio"},domProps:{value:!0,checked:e._q(e.coachAccount,!0)},on:{change:function(t){e.coachAccount=!0}}}),e._v(" Coach Â  \n        "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.coachAccount,expression:"coachAccount"}],attrs:{type:"radio"},domProps:{value:!1,checked:e._q(e.coachAccount,!1)},on:{change:function(t){e.coachAccount=!1}}}),e._v(" Athlete\n      ")])]),e._v(" "),n("div",{staticClass:"btn btn-primary btn-small",on:{click:e.changeAccountType}},[e._v("Save")])]),e._v(" "),e.user.coach?e._e():n("div",{staticClass:"settings-section"},[n("div",{staticClass:"settings-label"},[e._v(" Team ")]),e._v(" "),e.user.team_id?n("div",{staticClass:"d-flex align-items-center"},[n("div",{staticClass:"tag mr-2 mb-0"},[e._v(" \n        "+e._s(e.user.team_id)+"\n      ")]),e._v(" "),n("div",{staticClass:"btn btn-primary",on:{click:e.leaveTeam}},[e._v("\n        Leave\n      ")])]):n("div",{staticClass:"d-flex flex-shrink w-50"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.joinCode,expression:"joinCode"}],staticClass:"form-control mr-2",attrs:{type:"text",placeholder:"Join Code"},domProps:{value:e.joinCode},on:{input:function(t){t.target.composing||(e.joinCode=t.target.value)}}}),e._v(" "),n("div",{staticClass:"btn btn-primary",on:{click:e.joinTeam}},[e._v(" Join ")])])]),e._v(" "),n("div",{staticClass:"settings-section danger-zone pb-4"},[n("div",{staticClass:"settings-label"},[e._v("Danger Zone")]),e._v(" "),e.makeSure?e._e():n("button",{staticClass:"btn btn-danger",on:{click:function(t){e.makeSure=!0}}},[e._v("\n      Delete your account "),n("fa",{attrs:{icon:"trash-alt"}})],1),e._v(" "),e.makeSure?n("div",{staticClass:"alert alert-info make-sure"},[e._v("\n      Are you sure? This cannot be undone.\n    ")]):e._e(),e._v(" "),e.makeSure?n("button",{staticClass:"btn btn-default make-sure",on:{click:function(t){e.makeSure=!1}}},[e._v("\n      No\n    ")]):e._e(),e._v(" "),e.makeSure?n("button",{staticClass:"btn btn-danger make-sure",on:{click:e.deleteAccount}},[e._v("\n      Yes, delete my account\n    ")]):e._e(),e._v(" "),e.deleteSuccess?n("div",{staticClass:"alert alert-success"},[e._v(" \n      "+e._s(e.deleteSuccess)+" \n    ")]):e._e()])],1)])}),[],!1,null,"719066e0",null);t.default=component.exports}}]);