{"version":3,"file":"032dbd51dccf19ba2765.js","sources":["webpack:///./pages/races/_id/_gender/_event.vue"],"sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nconst RaceHeader = ()  => import('~/components/RaceHeader')\nconst RaceActions = () => import('~/components/RaceActions')\nconst ResultEditor = () => import('~/components/ResultEditor')\nconst RaceEditor = () => import('~/components/RaceEditor')\nconst ResultsTable = () => import('~/components/ResultsTable')\n\nexport default {\n  components: {\n    RaceHeader, \n    RaceActions, \n    ResultEditor,\n    RaceEditor, \n    ResultsTable\n  },\n  head () {\n    return {\n      title: this.currentRace.name + \" - RaceBase\",\n      meta: [{\n        hid: \"OpenGraph title\", \n        property: \"og:title\", \n        content: this.currentRace.name\n      }, {\n        hid: \"OpenGraph image\", \n        property: \"og:image\", \n        content: process.env.ROOT_URL + '/images/opengraph/results.png'\n      }, \n      {\n        hid: \"OpenGraph description\", \n        property: \"og:description\", \n        content: this.currentRace.date + \" at \" + this.currentRace.location\n      }]\n    }\n  },\n  computed: {\n    isLoggedIn: function() {\n      return this.$store.getters['auth/isLoggedIn']\n    }\n  },\n  async asyncData ({ $axios, params, redirect, store }) {\n    let race = await $axios.$get('race/' + params.id)\n    let events = {}\n\n    let gender = params.gender || \"mens\"\n\n    if (!race.message) \n      events = await $axios.$get('race/' + race._id + '/' + gender + '/events')\n    else \n      redirect('/races/notfound')\n\n    let eventNum = (Number(params.event) || 0)\n    eventNum = eventNum < events.length ? eventNum : 0\n\n    var voteData\n\n    if (store.getters['auth/isLoggedIn']) {\n      voteData = await $axios.$get('race/vote/' + params.id).catch((err) => { \n        console.log(err);\n      })\n    }\n\n    else \n      voteData = {}\n\n    let results = await $axios.$get(\n      'result/list/' \n      + race._id \n      + '/' \n      + gender\n      + '/'\n      + encodeURI(events[eventNum])\n    ).catch(() => {\n      redirect('/races/notfound')\n    })\n\n    let teamResults = await $axios.$get(\n      'result/teamlist/' \n      + race._id \n      + '/' \n      + gender \n      + '/'\n      + encodeURI(events[eventNum])\n    ).catch(() => {\n      redirect('/races/notfound') \n    })\n\n    return {\n      currentRace: race, \n      eventList: events, \n      eventNum: eventNum, \n      results: results, \n      teamResults: teamResults, \n      gender: gender, \n      voteData: voteData\n    } \n  },\n  data () {\n    return {\n      message: \"\", \n      editMode: false,\n      addMode: false,\n      editingRace: false,\n      currentResult: {}\n    }\n  },\n  methods : {\n    loadResults: async function() {\n\n      this.eventList = await this.$axios.$get('race/' + this.currentRace._id + '/' + this.gender + '/events')\n        .catch(() => { console.log(\"Something went wrong getting the events list.\") })\n\n      this.results = await this.$axios.$get(\n        'result/list/' \n        + this.currentRace._id \n        + '/' \n        + this.gender \n        + '/'\n        + encodeURI(this.eventList[this.eventNum])\n      ).catch(() => {\n        console.log(\"Something went wrong.\")\n      })\n\n      this.teamResults = await this.$axios.$get(\n        'result/teamlist/' \n        + this.currentRace._id \n        + '/' \n        + this.gender \n        + '/'\n        + encodeURI(this.eventList[this.eventNum])   \n      ).catch(() => {\n        console.log(\"Something went wrong.\")\n      })\n\n    },\n    loadRace: async function(shouldLoadResults) {\n      console.log(shouldLoadResults)\n      this.currentRace = await this.$axios.$get('race/' + this.currentRace._id)\n      if (shouldLoadResults)\n        this.loadResults()\n    },\n    closeWindow: function() {\n      this.addMode = false\n      this.editMode = false\n      this.editingRace = false\n      this.currentResult = {}\n    },\n    openAddWindow: function() {\n      this.addMode = true\n      this.editMode = false\n      this.editingRace = false\n    },\n    openEditWindow: function(result) {\n      this.addMode = false\n      this.editMode = true\n      this.currentResult = result\n    },\n    editRace: function() {\n      this.addMode = false\n      this.editMode = false\n      this.addingRace = false\n      this.editingRace = true\n    }\n  }, \n  watch: {\n    $route: function () {\n      this.gender = this.$route.params.gender || this.gender\n      this.eventNum = this.$route.params.event || 0\n      this.updateResults()\n    } \n  }\n}\n"],"mappings":"AAiDA","sourceRoot":""}